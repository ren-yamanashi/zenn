---
title: "CDK ã« ESLint ã‚’å°å…¥ã™ã‚‹"
published: true
cssclass: zenn
emoji: "ğŸ•Œ"
type: "tech"
topics: ["AWS", "TypeScript", "ESLint", "AWS CDK"]
url: "https://zenn.dev/yamaren/articles/6c1fd7c04aa25c"
---

## ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã§ã¯ã€CDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« ESLint ã‚’å°å…¥ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

:::message
ã“ã®è¨˜äº‹ã¯ã€TypeScript ã§æ›¸ã‹ã‚ŒãŸ CDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¯¾è±¡ã¨ã—ã¦ã„ã¾ã™ã€‚
:::

## ESLint ã¨ã¯ï¼Ÿ

ãã‚‚ãã‚‚ã€ESLint ã¨ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ESLint ã¯ã€JavaScript ã‚„ TypeScript ãªã©ã®ã‚³ãƒ¼ãƒ‰ã‚’è§£æã—ã€å˜ç´”ãªæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã‚„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦å‰‡ã«é•åã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ¤œå‡ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼é–“ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦å‰‡(æ›¸ãæ–¹)ã‚’çµ±ä¸€ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

https://eslint.org/

## 1. ESLint ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãã‚Œã§ã¯ã€CDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« ESLint ã‚’å°å…¥ã™ã‚‹æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

ã¾ãšã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™  
(ä»Šå›ã¯ ESLint ã¨ã€ESLint ã® TypeScript ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™)

```bash
# npm
npm install -D eslint typescript-eslint

# yarn
yarn add -D eslint typescript-eslint

# pnpm
pnpm install -D eslint typescript-eslint
```

:::message

ç¾åœ¨ ESLint ã® v8 ä»¥ä¸‹ã¯ EOL(End Of Life) ã§ã‚ã‚‹ãŸã‚ã€å¿…ãš v9 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„
:::

## 2. package.json ã®è¨­å®š

ç¶šã„ã¦ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ ESLint ã®ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã« package.json ã® `scripts` ã« lint ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™  
(`--fix`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ã€è‡ªå‹•çš„ãªä¿®æ­£ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚)

```diff json:package.json
{
  "scripts": {
+   "lint": "eslint .",
+   "lint:fix": "eslint . --fix"
  }
}
```

## 3. ESLint ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

ç¶šã„ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆã«`eslint.config.mjs`ã‚’ä½œæˆã—ã¾ã™

```javascript:eslint.config.mjs
import eslint from "@eslint/js";
import tsEslint from "typescript-eslint";

export default tsEslint.config(
  // ESLintã®æ¨å¥¨è¨­å®šã‚’é©ç”¨
  eslint.configs.recommended,
  ...tsEslint.configs.recommended,
  {
    // lib ã¨ bin ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã® typescript ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«ã™ã‚‹
    files: ["lib/**/*.ts", "bin/*.ts"],
    languageOptions: {
      parserOptions: {
        projectService: true,
        project: "./tsconfig.json",
      },
    },
    plugins: {},
    rules: {},
  },
  // ç„¡è¦–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®š
  {
    ignores: ["cdk.out", "node_modules", "*.js"],
  }
);
```

## 4. ã‚¨ãƒ‡ã‚£ã‚¿ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

æœ€å¾Œã«ã€ESLint ã«è¨­å®šã—ãŸãƒ«ãƒ¼ãƒ«ã«é•åã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§å¯è¦–åŒ–ã§ãã‚‹ã‚ˆã†ã«ã€æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚(VSCode ã®å ´åˆ)  
ã“ã“ã¾ã§ã§ã€åŸºæœ¬çš„ãªå°å…¥ã¯å®Œäº†ã§ã™(ç°¡å˜ï¼ï¼)

https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint

ã¾ãŸã€`.vscode/settings.json` ã«ä»¥ä¸‹ã®å†…å®¹ã‚’è¿½è¨˜ã—ã¾ã™

```diff json:.vscode/settings.json
{
+ "eslint.useFlatConfig": true,
 ...
}
```

## å‹•ä½œç¢ºèª

åŸºæœ¬çš„ãªå°å…¥ãŒå®Œäº†ã—ãŸã®ã§ã€ä»¥ä¸‹ã®æ‰‹é †ã§å‹•ä½œç¢ºèªã‚’è¡Œã„ã¾ã™ã€‚

1. ã‚ã‚‰ã‹ã˜ã‚ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«é•åã®ã‚³ãƒ¼ãƒ‰ã‚’ã€lib ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã‚ã¦ãŠãã¾ã™

```ts:lib/my-stack.ts
const a:any = ""
```

2. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€è©²å½“ç®‡æ‰€ãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã‹ã‚’æ¤œè¨¼ã—ã¾ã™

```bash
# npm
npm run lint

# yarn
yarn lint

# pnpm
pnpm lint
```

::::details ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ã¯ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ãŒã€ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ã¯å‡ºãªã„

ã“ã®ã‚ˆã†ãªå•é¡Œã«ç›´é¢ã—ãŸå ´åˆã«ã¯ã€æ‹¡å¼µæ©Ÿèƒ½ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¦‹ç›´ã™ãƒ»ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ãƒªãƒ­ãƒ¼ãƒ‰(ã¾ãŸã¯å†èµ·å‹•)ã™ã‚‹ãªã©ã®å¯¾å¿œãŒæœ‰åŠ¹ã ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚(ã‚¨ãƒ‡ã‚£ã‚¿ã®å•é¡Œã§ã‚ã‚‹ãŸã‚)

<br />

#### ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºãªã„

ã“ã®ã‚ˆã†ãªå•é¡Œã«ç›´é¢ã—ãŸå ´åˆã«ã¯ã€`npm run lint --debug`ã‚’å®Ÿè¡Œã—ã¦ã€ESLint ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã“ã¨ãŒæœ‰åŠ¹ã ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

è©³ã—ãã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ãã ã•ã„

https://eslint.org/docs/latest/use/configure/debug
::::

## ãƒ«ãƒ¼ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

ä¸Šè¨˜ã® `eslint.config.mjs` ã§ã¯ recommended ã®ãƒ«ãƒ¼ãƒ«ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚  
ã‚‚ã—ã€**ãã®ä¸­ã§ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦æ¬²ã—ããªã„ãƒ«ãƒ¼ãƒ«**ã€**ãã®ä¸­ã«ã¯ãªã„ãŒã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦æ¬²ã—ã„ãƒ«ãƒ¼ãƒ«** ãŒã‚ã‚‹å ´åˆã¯ã€ESLint ãƒ«ãƒ¼ãƒ«ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ã§è§£æ±ºã§ãã¾ã™ã€‚

### ãƒ«ãƒ¼ãƒ«ã‚’å¤‰æ›´ã™ã‚‹

ä¾‹ãˆã°ã€ã€Œä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å¤‰æ•°ãŒã‚ã£ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ã—ãŸããªã„ã€ã¨ã„ã†å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã¾ã™ã€‚

```diff js:eslint.config.mjs
import eslint from "@eslint/js";
import tsEslint from "typescript-eslint";

export default tsEslint.config(
    // çœç•¥
    rules: {
+     "no-unused-vars": "off",
+     "@typescript-eslint/no-unused-vars": "off"
    },
  },
);
```

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å°å…¥ã™ã‚‹

ESLint ã«ã¯ `eslint-plugin-awscdk` ã¨ã„ã† CDK ç”¨ã®ä¾¿åˆ©ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚Šã€ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ä»¥ä¸‹ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

https://eslint-plugin-awscdk.dev/ja/

#### å‘½åè¦å‰‡ã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«

| æ¦‚è¦ | æ¨å¥¨ãƒ«ãƒ¼ãƒ«ã«å«ã¾ã‚Œã‚‹ |
|---------|------|
| Construct ã® constructor ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ 'scope, id' ã¾ãŸã¯ 'scope, id, props' ã‚’æŒ‡å®šã™ã‚‹ | âœ… |
| Construct ID ã« "Construct" ã‚„ "Stack" ãªã©ã® suffix ã‚’ã¤ã‘ãªã„ | âœ… |
| Construct ID ã« è¦ª Construct ã®åå‰ã‚’ã¤ã‘ãªã„ | âœ… |
| Construct ID ã«å¤‰æ•°ã‚’ä½¿ç”¨ã—ãªã„ | âœ… |
| Construct ID ã¯ PascalCase ã§æ›¸ã | âœ… |
| Construct ã® Props ã¯ `${Constructå}Props` ã®å½¢å¼ã§æ›¸ã | |

#### å®‰å…¨æ€§ã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«

| æ¦‚è¦ | æ¨å¥¨ãƒ«ãƒ¼ãƒ«ã«å«ã¾ã‚Œã‚‹ |
|---------|------|
| Props(Interface) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ "readonly" ã‚’ã¤ã‘ã‚‹ | âœ… |
| Construct ã® public å¤‰æ•°ã«ã¯ "readonly" ã‚’ã¤ã‘ã‚‹ | âœ… |
| Props ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« Construct å‹ã‚’æŒ‡å®šã—ãªã„ | âœ… |
| Construct ã® public ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« Construct å‹ã‚’æŒ‡å®šã—ãªã„ | âœ… |
| Construct ã® constructor ã®ç¬¬äºŒå¼•æ•° (`scope` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£) ã«ã¯å¿…ãš `this` ã‚’æ¸¡ã™ | âœ… |

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«

| æ¦‚è¦ | æ¨å¥¨ãƒ«ãƒ¼ãƒ«ã«å«ã¾ã‚Œã‚‹ |
|---------|------|
| private ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã€å¤–éƒ¨ã‹ã‚‰å‘¼ã³å‡ºã•ãªã„ | |

#### ã‚³ãƒ¡ãƒ³ãƒˆã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«

| æ¦‚è¦ | æ¨å¥¨ãƒ«ãƒ¼ãƒ«ã«å«ã¾ã‚Œã‚‹ |
|---------|------|
| Props(Interface) ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ Construct ã® public ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ JSDoc ã‚’æ›¸ã | |
| Props(Interface) ã®ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¯ '@default' JSDoc ã‚’æ›¸ã | |

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å°å…¥æ‰‹é †

`eslint-plugin-awscdk`ã®å°å…¥æ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™

**1. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

```bash
# npm
npm install --save-dev eslint-plugin-awscdk

# yarn
yarn add -D eslint-plugin-awscdk

# pnpm
pnpm install -D eslint-plugin-awscdk
```

**2. eslint.config.mjs ã®æ›´æ–°**

```diff js:eslint.config.mjs
import eslint from "@eslint/js";
import tsEslint from "typescript-eslint";
+import cdkPlugin from "eslint-plugin-awscdk";

export default tsEslint.config(
  // ESLintã®æ¨å¥¨è¨­å®šã‚’é©ç”¨
  eslint.configs.recommended,
  ...tsEslint.configs.recommended,
  {
    // libã¨binãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã®tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«ã™ã‚‹
    files: ["lib/**/*.ts", "bin/*.ts"],
+   extends: [cdkPlugin.configs.recommended],
    // ...ãã®ä»–ã®è¨­å®š
  },
);
```

## ã¾ã¨ã‚

ä»Šå›ã¯ã€CDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« ESLint ã‚’å°å…¥ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

ESLint ã®å°å…¥ã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªå‘ä¸Šã¨ãƒãƒ¼ãƒ é–‹ç™ºã®åŠ¹ç‡åŒ–ãŒæœŸå¾…ã§ãã¾ã™ã€‚
ç‰¹ã«ã€`eslint-plugin-awscdk` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€CDK ç‰¹æœ‰ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚‚è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ESLint ã‚’ä½¿ã„ã“ãªã—ã¦ã€å¿«é©ãª CDK é–‹ç™ºã‚’è¡Œã„ã¾ã—ã‚‡ã†ï¼ï¼

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ESLint ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

https://eslint.org/docs/latest/

typescript-eslint ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

https://typescript-eslint.io/getting-started/

eslint-plugin-awscdk ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(æ—¥æœ¬èª)

https://eslint-plugin-awscdk.dev/ja/
